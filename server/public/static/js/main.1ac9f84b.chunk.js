(this.webpackJsonppoll=this.webpackJsonppoll||[]).push([[0],{107:function(e,t){},110:function(e,t,n){"use strict";n.r(t);var a,o=n(0),l=n.n(o),r=n(46),i=n.n(r),c=(n(56),n(57),n(6)),s=n(3),u=n(9),m=n(8),p=n.n(m),d=n(13),f=n.n(d),v=function(e){return l.a.createElement("div",{className:f.a.container},e.id?l.a.createElement("input",{className:f.a.input,onChange:function(t){return e.handler(e.id,t)},value:e.title}):l.a.createElement("input",{className:f.a.input,onChange:e.handler,value:e.title}))},_=n(7),E=n.n(_),h=n(47),g=n.n(h),b=function(){var e=Object(o.useState)({title:""}),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)({options:[]}),i=Object(u.a)(r,2),m=i[0],d=i[1],f=function(e,t){var n,a=Object(s.a)({},m),o=Object(c.a)(a.options);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.id===e){l.title=t.target.value;break}}}catch(r){o.e(r)}finally{o.f()}d(a)};return l.a.createElement("div",{className:E.a.container},l.a.createElement("h1",null,"Create Poll"),l.a.createElement("label",null,"Poll Title:"),l.a.createElement(v,{handler:function(e){var t=Object(s.a)({},n);t.title=e.target.value,a(t)},title:n.title}),l.a.createElement("div",{className:E.a.add},l.a.createElement("label",null,"Options:"),l.a.createElement("div",null,m.options.map((function(e){return l.a.createElement(v,{key:e.id,id:e.id,handler:f,title:e.title})}))),l.a.createElement("div",{className:E.a.commands},l.a.createElement("button",{className:E.a.Btn,onClick:function(){var e=Object(s.a)({},m),t={id:g()(),title:"",votes:0};e.options.push(t),d(e)}},"+"),l.a.createElement("button",{className:E.a.Btn,onClick:function(){console.log(n.title,m.options);var e={title:n.title,options:m.options};p.a.post("/api/poll/",e).then((function(e){console.log(e.data)})).catch((function(e){console.log(e)})),a({title:""}),d({options:[]})}},"Submit"))))},O=n(21),N=n.n(O),C=n(48),k=n(49),y=n.n(k),j=n(50),I=n.n(j),S=n(2),w=n.n(S),x=new l.a.createContext({vote:function(){}}),A=function(e){var t=Object(o.useContext)(x),n=parseFloat(parseInt(e.votes)/parseInt(e.sum)*100).toFixed(1),a={width:n+"%"};if(null!==localStorage.getItem("marked")){var r,i=JSON.parse(localStorage.marked),s=Object(c.a)(i);try{for(s.s();!(r=s.n()).done;){if(r.value===e.ID)return l.a.createElement("div",{className:w.a.offContainer,style:a},l.a.createElement("div",{className:w.a.stat},n,"%"),l.a.createElement("div",{className:w.a.title},e.title))}}catch(u){s.e(u)}finally{s.f()}return l.a.createElement("div",{className:w.a.container,onClick:function(){return t.vote(e.title,e.ID)}},l.a.createElement("div",{className:w.a.stat},e.votes),l.a.createElement("div",{className:w.a.title},e.title))}return l.a.createElement("div",{className:w.a.container,onClick:function(){return t.vote(e.title,e.ID)}},l.a.createElement("div",{className:w.a.stat},e.votes),l.a.createElement("div",{className:w.a.title},e.title))},D=n(22),L=n.n(D),P=function(e){var t,n=0,a=Object(c.a)(e.options);try{for(a.s();!(t=a.n()).done;){var o=t.value;n+=parseInt(o.votes)}}catch(r){a.e(r)}finally{a.f()}return l.a.createElement("div",{className:L.a.container},l.a.createElement("h2",null,e.title),l.a.createElement("div",{className:L.a.optionsContainer},e.options.map((function(t,a){return l.a.createElement(A,{key:a,ID:e.ID,title:t.title,votes:t.votes,sum:n})}))))},J=function(){var e=Object(o.useState)({error:null,isLoaded:!1,pollArray:null}),t=Object(u.a)(e,2),n=t[0],r=t[1];Object(o.useEffect)((function(){function e(){return(e=Object(C.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.a.get("/api/poll/").then((function(e){var t=e.data;t.reverse(),r({error:!1,isLoaded:!0,pollArray:t})})).catch((function(e){r({error:e,isLoaded:!0,pollArray:null})}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}a=I()(),function(){e.apply(this,arguments)}()}),[]),Object(o.useEffect)((function(){return a.on("voteCasted",(function(e){var t=e;t.reverse(),console.log("voteCasted_Client"),r(Object(s.a)(Object(s.a)({},n),{},{pollArray:t}))})),a.on("newPoll",(function(e){var t=e;t.reverse(),r(Object(s.a)(Object(s.a)({},n),{},{pollArray:t}))})),a.on("pollListSent",(function(e){void 0!==e&&null!==e&&localStorage.setItem("marked",e)})),function(){a.off("voteCasted"),a.off("newPoll"),a.off("pollListSent")}}));return n.error?l.a.createElement("h1",null,n.error.message):n.isLoaded?l.a.createElement(x.Provider,{value:{vote:function(e,t){p.a.post("/api/poll/"+t,{optionTitle:e}).then((function(e){if(console.log(e.data.message),void 0===localStorage.marked)localStorage.setItem("marked",JSON.stringify([t]));else{var n=JSON.parse(localStorage.marked);n.push(t),localStorage.setItem("marked",JSON.stringify(n))}})).catch((function(e){console.log(e)}))}}},l.a.createElement("div",{className:y.a.container},l.a.createElement("h1",null,"Recent Polls"),n.pollArray.map((function(e){return l.a.createElement(P,{key:e._id,title:e.title,options:e.options,ID:e._id})})))):l.a.createElement("h1",null,"Loading ...")},B=function(){return l.a.createElement("div",{className:"LayoutContainer"},l.a.createElement(b,null),l.a.createElement(J,null))};var F=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(B,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},13:function(e,t,n){e.exports={container:"Input_container__SDDmJ",label:"Input_label__3atXj",input:"Input_input__3jMg0"}},2:function(e,t,n){e.exports={container:"Option_container__1ICml",stat:"Option_stat__eAzNu",title:"Option_title__1enRN",offContainer:"Option_offContainer__PHgOD"}},22:function(e,t,n){e.exports={container:"Poll_container__3r6FE",optionsContainer:"Poll_optionsContainer__2qsu0"}},49:function(e,t,n){e.exports={container:"PollList_container__qLcIb"}},51:function(e,t,n){e.exports=n(110)},56:function(e,t,n){},57:function(e,t,n){},7:function(e,t,n){e.exports={container:"Cockpit_container__1YOcl",add:"Cockpit_add__2IAdD",commands:"Cockpit_commands__2v8Al",Btn:"Cockpit_Btn__3ugxw"}}},[[51,1,2]]]);
//# sourceMappingURL=main.1ac9f84b.chunk.js.map